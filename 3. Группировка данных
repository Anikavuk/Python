# 1. Меломаны у нас есть. Сейчас узнаем идентификатор user_id одного из них. 
# Для этого сгруппируем данные по каждому пользователю, чтобы собрать жанры прослушанных им композиций.
# Сгруппируйте DataFrame по столбцу user_id, сохраните полученный результат в переменной genre_grouping.
# Посчитайте количество жанров, которые выбрали пользователи, методом count(), указав, что выбираем один 
# столбец genre_name. Сохраните результат в переменной genre_counting и выведите первые 30 строк этой таблицы.
# Подсказка
# Для вывода результата используйте функцию print() и метод head(30).
import pandas as pd
df = pd.read_csv('music_log_upd.csv')

genre_grouping = df.groupby('user_id')['genre_name']


def user_genres(group):
    for col in group:
        if len(col[1]) > 50:
            user = col[0]
            return user
search_id = user_genres(genre_grouping)
print(search_id)

174C0ED6

# 2. Быть может, те, кто за день слушает больше 50 песен, имеют более широкие предпочтения. 
# Чтобы найти такого, изготовим универсальный инструмент.
# Напишите функцию user_genres, которая принимает некую группировку как свой аргумент group. Функция должна перебирать группы, входящие в эту группировку.
# В каждой группе два элемента — имя группы с индексом 0 и список значений с индексом 1.
# Обнаружив такую группу, в которой список (элемент с индексом 1) содержит более 50 значений, функция возвращает имя группы (значение элемента с индексом 0).
# Подсказка
#  Внимательно прочитайте комментарии в коде, это подробная инструкция, которая не даст вам ошибиться.
import pandas as pd
df = pd.read_csv('music_log_upd.csv')

def user_genres(group):
    for col in group:
        if len(col[1]) > 50: # назначьте условие: если длина столбца col с индексом 1 больше 50, тогда
            user = col[0]# в переменной user сохраняется элемент col[0]
            return user
            
            
# 3.Вызовите функцию user_genres, как аргумент передайте ей genre_grouping. 
# Результат – user_id одного из неведомых нам любителей музыки – сохраните в переменной search_id и выведите значение на экран.
# Подсказка Для вывода на экран вызовите функцию print(). 

import pandas as pd
df = pd.read_csv('music_log_upd.csv')

genre_grouping = df.groupby('user_id')['genre_name']


def user_genres(group):
    for col in group:
        if len(col[1]) > 50:
            user = col[0]
            return user
search_id = user_genres(genre_grouping)
print(search_id)

174C0ED6
